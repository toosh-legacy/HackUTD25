# Reddit Sentiment Integration

This integration scrapes Reddit's T-Mobile subreddits for sentiment analysis and includes it in the overall happiness average.

## Setup

### 1. Install Python Dependencies

```bash
pip install praw pandas vaderSentiment
```

### 2. Configure Reddit API Credentials

Edit `backend/reddit-scraper.py` and replace with your actual Reddit API credentials:
- Get credentials from: https://www.reddit.com/prefs/apps
- Click "create another app" → choose "script"
- Copy client_id and client_secret

### 3. Run the Services

You need to run **3 separate terminals**:

#### Terminal 1: Main Backend (Port 4000)
```bash
cd backend
npm run dev
```

#### Terminal 2: Reddit Happiness Server (Port 3001)
```bash
cd backend
node reddit-happiness-server.js
```

#### Terminal 3: Reddit Scraper (Python)
```bash
cd backend
python reddit-scraper.py
```

## How It Works

1. **Python Scraper** (`reddit-scraper.py`):
   - Scrapes r/tmobile and r/tmobileisp every 30 minutes
   - Analyzes sentiment using VADER
   - Saves happiness index (0-100) to `happiness.json`

2. **Node Server** (`reddit-happiness-server.js`):
   - Serves the happiness.json data via API
   - Runs on port 3001

3. **Main Backend**:
   - Fetches Reddit happiness from port 3001
   - Combines it with user feedback
   - Reddit happiness = 50% weight, All user feedback = 50% weight

## File Structure

```
backend/
├── reddit-scraper.py          # Python scraper
├── reddit-happiness-server.js # Node.js server for happiness data
├── happiness.json             # Generated by scraper (auto-created)
└── src/
    └── services/
        └── feedback.service.js # Updated to include Reddit data
```

## Testing Without Scraper

If you want to test without running the scraper, create a test file:

```bash
echo '{"happiness": 65.5}' > backend/happiness.json
```

Then start the Reddit happiness server and your main backend will include this in the average.

## Notes

- The scraper runs every 30 minutes
- If Reddit API is unavailable, the system falls back to user feedback only
- Reddit happiness is weighted equally with all user feedback combined
- First run may take a few minutes to collect enough data
